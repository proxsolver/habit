### **프로그램 구조 (Application Architecture)**

이 프로그램은 **바닐라 자바스크립트(Vanilla JavaScript)**와 **Firebase**를 기반으로 구축된 동적인 **웹 기반 루틴 트래커**입니다. 사용자는 구글 계정으로 로그인하여 개인화된 루틴을 관리하고 진행 상황을 추적할 수 있습니다.

#### **1. `index.html` - 화면의 뼈대 (UI Structure)**

HTML 파일은 웹 애플리케이션의 전체적인 구조와 사용자 인터페이스(UI) 요소들을 정의합니다.

* **인증 영역 (`auth-container`):** 구글 로그인 버튼과 로그인 후 사용자 정보를 표시하는 영역입니다.
* **메인 앱 콘텐츠 (`main-app-content`):**
    * **일일 진행률 (`daily-progress`):** 오늘의 전체 루틴 진행률을 시각적으로 보여주는 프로그레스 바입니다.
    * **루틴 목록 섹션:** '남은 루틴', '진행 중', '완료', '건너뛴 루틴'으로 상태에 따라 루틴을 분류하여 보여줍니다.
    * **루틴 관리 페이지 (`manage-section`):** 루틴 순서를 변경하고, 루틴을 편집/삭제할 수 있는 관리자 페이지입니다.
* **대시보드 (`dashboard-view`):**
    * '독서', '운동', '수면' 등 핵심 영역의 성과를 그래프와 통계로 시각화하여 보여주는 페이지입니다.
    * **Chart.js** 라이브러리를 사용하여 데이터를 시각화합니다.
* **모달 창 (Modals):**
    * 다양한 사용자 입력을 받기 위한 여러 종류의 모달(팝업) 창이 준비되어 있습니다.
    * (새 루틴 추가, 숫자/시간/독서량 입력, 영역 관리 등)
* **하단 네비게이션 (`navigation-buttons`):** '홈', '관리', '루틴 추가', '통계' 페이지로 빠르게 이동할 수 있는 버튼입니다.
* **외부 라이브러리 연동:**
    * **Firebase:** 인증, 데이터베이스(Firestore) 기능을 위해 연동합니다.
    * **Tailwind CSS & Chart.js:** UI 디자인과 데이터 시각화를 위해 CDN 방식으로 연동합니다.
    * **Sortable.js:** '루틴 관리' 페이지의 드래그 앤 드롭 기능을 위해 연동합니다.

---

#### **2. `script.js` - 앱의 두뇌 (Application Logic)**

JavaScript 파일은 애플리케이션의 모든 동적 기능과 로직을 담당합니다.

* **전역 상태 관리:** `currentUser`, `sampleRoutines` 등 앱의 현재 상태를 저장하는 변수들을 관리합니다.
* **Firebase 연동 로직:**
    * **인증 (Authentication):** 구글 계정을 이용한 로그인/로그아웃 처리를 담당합니다.
    * **데이터베이스 (Firestore):** 사용자의 모든 데이터(루틴, 영역, 통계)를 Firestore에 저장하고 불러오는 CRUD(Create, Read, Update, Delete) 함수들을 정의합니다.
* **페이지 및 UI 렌더링:**
    * `renderRoutines`, `renderManagePage` 등의 함수를 통해 Firestore에서 불러온 데이터를 기반으로 HTML 화면을 동적으로 생성하고 업데이트합니다.
* **이벤트 핸들링:**
    * 사용자의 모든 인터랙션(버튼 클릭, 값 입력, 드래그 등)을 감지하고 그에 맞는 동작(데이터 업데이트, UI 변경 등)을 실행합니다.
* **모달 관리:** 각 상황에 맞는 모달 창을 열고 닫으며, 모달 내에서의 사용자 입력을 처리합니다.
* **페이지 네비게이션:** 하단 버튼 클릭 시, 화면의 내용을 '홈', '관리', '대시보드' 등으로 전환합니다.
* **유틸리티 함수:** 날짜 계산, 값 포맷팅, 상태 확인(완료/진행중 여부) 등 반복적으로 사용되는 보조 기능들을 함수로 정의하여 사용합니다.

---

#### **3. `styles.css` - 앱의 옷과 화장 (Visual Design)**

CSS 파일은 애플리케이션의 시각적인 모든 요소를 책임집니다.

* **전역 스타일 및 변수 (`:root`):** 앱 전체에서 일관되게 사용될 색상, 폰트, 그림자 등을 CSS 변수로 정의하여 유지보수성을 높였습니다.
* **레이아웃:** 모바일 화면에 최적화된 중앙 정렬 레이아웃을 정의합니다.
* **컴포넌트 스타일링:**
    * **루틴 아이템:** 시간대와 상태에 따라 각기 다른 색상과 스타일을 적용합니다.
    * **버튼, 모달, 프로그레스 바:** 사용자가 앱과 상호작용하는 모든 UI 요소에 대한 세부 디자인을 정의합니다.
* **애니메이션 및 효과:** `fadeInUp`, `pulse`, `confetti` 등 사용자에게 긍정적인 경험을 제공하기 위한 다양한 애니메이션 효과를 포함합니다.
* **반응형 디자인 (`@media`):** 모바일(최대 480px) 환경에 초점을 맞춰 스타일이 작성되었습니다.


---

2. 프로젝트 개요 (Project Overview)
프로젝트명: 가족 루틴 트래커

핵심 기술 스택: Vanilla JavaScript, Firebase(Authentication, Firestore), HTML, CSS

주요 라이브러리: Tailwind CSS (CDN), Chart.js (CDN), D3.js (CDN), Cal-Heatmap.js (CDN)

3. 응답 형식 및 스타일 요구사항 (Response Format & Style)
기본 언어: 한글을 기본으로 하되, 기술 용어 등 필요한 경우 영어 혼용 가능

응답 구조: 항상 논리적인 구조(예: 현상 분석 → 원인 규명 → 해결 방안)에 기반한 답변 선호

텍스트 정제: 최종 출력물은 유니코드 특수기호(불필요한 이모지 등)를 제거하여, 복사/붙여넣기 용이한 정제된 텍스트로 제공

코드 변경 안내: 코드의 추가, 삭제, 교체가 필요한 경우, 아래 예시와 같이 변경될 블록의 시작과 끝을 명확한 시각적 구분자(주석)로 감싸서 안내

코드 추가/삭제 시:

JavaScript

// ▼▼▼ 여기에 새 코드를 추가하세요 (또는 이 코드를 삭제하세요) ▼▼▼
... (변경될 코드 내용) ...
// ▲▲▲ 여기까지 추가 (또는 여기까지 삭제) ▲▲▲
최종 요약: 답변의 마지막에는 항상 해당 작업 내용을 요약하는 git commit 메시지를 한 줄로 제공

형식: git commit -am "type(scope): subject"

예시: git commit -am "fix(ui): 상세 모달 렌더링 버그 수정"

---
가족 루틴 트래커: 가족 기능 개발 계획
## 마일스톤 1: 사용자 역할 및 권한 시스템 구축 (기반)
가장 먼저, 현재의 단일 사용자 구조를 '가족' 단위로 묶고, 그 안에서 '부모'와 '자녀' 역할을 구분하는 기반 시스템을 구축해야 합니다.

Task 1: Firestore 데이터 모델 재설계

families 컬렉션을 신설하여 가족 그룹을 관리합니다.

기존 users 컬렉션의 각 사용자 문서(document)에 role ('parent' 또는 'child')과 familyId 필드를 추가하여 소속 가족과 역할을 명시합니다.

Task 2: 가족 관리 UI 개발

부모 역할의 사용자가 자신의 계정 관리 페이지에서 '가족 관리' 메뉴에 접근할 수 있도록 합니다.

이 페이지에서 자녀의 계정(이메일)을 입력하여 가족으로 초대하고, 자녀가 수락하면 familyId가 연결되는 기능을 구현합니다.

Task 3: 역할 기반 접근 제어(RBAC) 구현

부모: 모든 가족 구성원의 루틴을 조회하고, 자녀의 루틴을 생성/수정/삭제할 수 있는 권한을 가집니다.

자녀: 자신의 루틴만 조회 및 완료 처리할 수 있으며, 루틴을 임의로 수정하거나 삭제할 수 없도록 제한합니다. (특히 포인트 수정 불가)

위 규칙을 Firestore 보안 규칙과 애플리케이션 로직 양쪽에 모두 적용하여 데이터 무결성을 확보합니다.

## 마일스톤 2: 부모의 자녀 습관 관리 기능
기반 시스템 위에서, 부모가 실질적으로 자녀의 습관을 관리하고 감독하는 기능을 구현합니다.

Task 1: 부모용 대시보드 UI/UX 개선

현재의 루틴 화면에 '나의 루틴' 탭과 '자녀 이름' 탭을 두어, 부모가 쉽게 화면을 전환하며 현황을 파악할 수 있도록 UI를 개선합니다.

Task 2: 자녀 루틴 생성 및 할당 기능

부모가 '새 루틴 추가' 모달에서 루틴을 생성할 때, 이 루틴을 '누구의 것'으로 할당할지(본인 또는 특정 자녀) 선택하는 드롭다운 메뉴를 추가합니다.

Task 3: 자녀 진행 상황 실시간 모니터링

부모가 '자녀 이름' 탭을 보고 있을 때, 해당 자녀가 루틴을 완료하면 실시간으로 화면이 업데이트되어 (예: '남은 루틴'에서 '완료한 루틴'으로 이동) 진행 상황을 즉각적으로 인지할 수 있도록 구현합니다.

## 마일스톤 3: 자녀용 인터페이스 및 포인트 시스템
자녀가 앱을 즐겁게 사용하고, 노력에 대한 명확한 보상을 받을 수 있는 환경을 구축합니다.

Task 1: 자녀용 UI/UX 간소화

자녀 계정으로 로그인 시, 10세 아들의 눈높이에 맞춰 '관리', '통계' 같은 복잡한 메뉴는 숨기고, 오직 '오늘의 할 일'과 '포인트 상점'만 간단하게 보여주는 간소화된 인터페이스를 제공합니다.

Task 2: 포인트 적립 로직 구현

자녀가 자신의 루틴을 '완료' 처리하면, 해당 루틴에 설정된 basePoints가 자녀의 user 문서 내 points 필드에 안전하게 누적되는 로직을 구현합니다.

Task 3: 포인트 수정 방지 기능 강화

자녀가 혹시 루틴 편집 화면에 접근하더라도, '포인트' 입력 필드는 disabled 처리하거나 아예 보이지 않도록 하여, 보상 체계의 공정성을 확보합니다.

## 마일스톤 4: 보상 시스템 구현
포인트를 실질적인 보상으로 연결하여 동기를 극대화하는 핵심 기능입니다. 두 가지 선택지를 모두 구현하는 방향으로 계획합니다.

Task 1: 보상 선택 허브 페이지 개발

자녀가 자신의 누적 포인트를 확인하고, '펫 키우기'와 '보상 요청하기' 중 어디에 포인트를 사용할지 선택하는 화면을 개발합니다.

Task 2: 옵션 A - 펫 키우기 게임 (Gamification)

기획: 간단한 성장 단계(알 → 유년기 → 성체)와 상호작용(먹이주기)을 정의합니다.

개발: 포인트로 '먹이' 아이템을 구매하고, '먹이주기' 버튼을 누르면 펫의 경험치(EXP)가 오르며 성장하는 시스템을 구현합니다. 펫의 상태(배고픔 등)를 시각적으로 표시합니다.

Task 3: 옵션 B - 현실 보상 연동 (Parent-Child Interaction)

기획: 부모가 '핸드폰 30분', '용돈 1,000원' 등 보상 목록과 필요 포인트를 미리 설정해두는 기능을 기획합니다.

개발: 자녀가 설정된 보상을 '포인트로 구매' 요청하면, 부모의 앱에 알림이 가고, 부모가 '승인' 버튼을 눌러야 실제 포인트가 차감되고 보상이 지급되는 프로세스를 구현합니다.

## 그 외 추가 아이디어 (For Future Synergy)
가족 랭킹 시스템: 주간/월간 단위로 가족 구성원(부모 포함)의 포인트 획득 랭킹을 보여주어 선의의 경쟁을 유도합니다.

공동 목표 설정: '이번 주 다 같이 1000포인트 모아서 주말에 피자 먹기' 같은 가족 공동 미션을 설정하고, 달성 시 모두에게 보너스 포인트를 지급합니다.

3세대 연동 (부친 참여): 70대 부친을 위해 '오늘의 약 복용 체크', '가벼운 산책하기' 등 매우 간단한 루틴을 추가하여, 완료 시 손주(10세 아들)의 펫에게 줄 수 있는 특별 간식을 얻는 등 세대 간 상호작용 요소를 추가할 수 있습니다.

주간 가족 리포트: 한 주간의 가족 전체 활동 요약, 가장 열심히 한 구성원, 가장 많이 한 루틴 등을 보여주는 리포트를 자동 생성하여 가족 간 대화의 소재를 제공합니다.
